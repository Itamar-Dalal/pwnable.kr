from pwn import *

context(log_level='info', os='linux', arch='i386')

#session = ssh(user='ascii_easy', host='pwnable.kr', port=2222, password='guest')
#p = session.process('./ascii_easy')

libc = ELF(r'/mnt/c/users/dalal/desktop/private_projects/ctf/pwnable.kr/ascii_easy/libc-2.15.so')

LIBC_BASE = 0x5555e000

open_offset = libc.symbols['open']
read_offset = libc.symbols['read']
write_offset = libc.symbols['write']

open_addr = hex(LIBC_BASE + open_offset)
read_addr = hex(LIBC_BASE + read_offset) 
write_addr = hex(LIBC_BASE + write_offset)

log.info(f"Open address: {open_addr}")
log.info(f"Read address: {read_addr}")
log.info(f"write address: {write_addr}")

libc_rop = ROP(libc)

#log.info(libc_rop.gadgets)
log.info(libc_rop.find_gadget(['int 0x80']))

